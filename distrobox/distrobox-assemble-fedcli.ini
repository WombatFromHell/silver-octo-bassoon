[fedcli]
image=fedora:41
additional_packages="wget gpg git curl fish bat fzf eza rdfind fd-find ripgrep zoxide"
additional_packages="xdg-desktop-portal-kde flatpak-xdg-utils fuse2"
additional_packages="egl-utils glx-utils vulkan-tools vainfo dn4"
# setup rpmfusion repo
init_hooks=sudo dnf install -y https://mirrors.rpmfusion.org/free/fedora/rpmfusion-free-release-$(rpm -E %fedora).noarch.rpm;
init_hooks=sudo dnf install -y https://mirrors.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-$(rpm -E %fedora).noarch.rpm;
init_hooks=sudo dnf config-manager setopt fedora-cisco-openh264.enabled=1;
# setup negativo17 repo
init_hooks=sudo dnf config-manager addrepo --from-repofile=https://negativo17.org/repos/fedora-nvidia.repo;
init_hooks=sudo dnf install -y nvidia-driver nvidia-driver-cuda libva-nvidia-driver;
# install optional codecs and media dependencies
init_hooks=sudo dnf swap ffmpeg-free ffmpeg --allowerasing -y;
init_hooks=sudo dnf4 install -y @multimedia --allowerasing --setopt="install_weak_deps=False" --exclude=PackageKit-gstreamer-plugin;
# setup firefox-dev repo and dependencies
init_hooks=sudo dnf copr enable -y the4runner/firefox-dev;
init_hooks=sudo dnf install -y firefox-dev pciutils;
# make some critical symlinks
init_hooks=ln -sf /usr/bin/distrobox-host-exec /usr/bin/podman;
init_hooks=ln -sf /usr/bin/distrobox-host-exec /usr/bin/podman-compose;
init_hooks=ln -sf /usr/bin/distrobox-host-exec /usr/bin/lazygit;
init_hooks=ln -sf /usr/bin/distrobox-host-exec /usr/bin/getenforce;
# symlink wl-clipboard
init_hooks=ln -sf /usr/bin/distrobox-host-exec /usr/bin/wl-copy;
init_hooks=ln -sf /usr/bin/distrobox-host-exec /usr/bin/wl-paste;
# symlink podman and bat
init_hooks=ln -sf /usr/bin/podman /usr/bin/docker;
init_hooks=ln -sf /usr/bin/podman /usr/bin/docker-compose;
# try to fix xdg-open in vscode (when interacting with flatpak firefox)
init_hooks=ln -sf /usr/bin/xdg-open /usr/bin/xdg-open-local;
init_hooks=ln -sf /usr/libexec/flatpak-xdg-utils/xdg-open /usr/bin/xdg-open;
#
start_now=false
pull=true
root=false
nvidia=false
replace=true
